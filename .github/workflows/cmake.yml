name: CMake

on:
    - push
    - pull_request

jobs:
    build:
        # Make sure this builds on a wide variety of systems
        strategy:
            fail-fast: false
            matrix:
                build_type:
                    - Release
                    - Debug
                os:
                    - ubuntu-22.04
                    - ubuntu-20.04

        runs-on: ${{ matrix.os }}

        steps:
            -   uses: actions/checkout@v3

            -   name: Install build dependencies
                run: ./install_build_deps.sh auto

            -   name: Configure CMake
                # Configure CMake in a 'build' subdirectory. `CMAKE_BUILD_TYPE` is only required if you are using a single-configuration generator such as make.
                # See https://cmake.org/cmake/help/latest/variable/CMAKE_BUILD_TYPE.html?highlight=cmake_build_type
                run: cmake -B ${{github.workspace}}/build -DCMAKE_BUILD_TYPE=${{ matrix.build_type }}

            -   name: Build
                # Build your program with the given configuration
                run: cmake --build ${{github.workspace}}/build --config ${{ matrix.build_type }} -j "$(nproc --all)"
